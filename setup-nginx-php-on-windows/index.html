<!doctype html>
<html lang="zh-Hans">
<head>
  <title>Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx/Apache å¼€å‘ç¯å¢ƒ - PRIN BLOG</title>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="generator" content="Hexo" />
<link rel="icon" href="/images/favicon.png" />
  <link rel="canonical" href="https://printempw.github.io/setup-nginx-php-on-windows/"/>
  <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="PRIN BLOG">
  <meta name="keywords" content="Nginx,PHP,Apache," />

<meta name="description" content="çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (printempw&#x2F;blessing-skin-server) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx&#x2F;Apache å¼€å‘ç¯å¢ƒ">
<meta property="og:url" content="https://printempw.github.io/setup-nginx-php-on-windows/index.html">
<meta property="og:site_name" content="PRIN BLOG">
<meta property="og:description" content="çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (printempw&#x2F;blessing-skin-server) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/nginx-php-works.png">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/wnmp-all-processes.png">
<meta property="article:published_time" content="2018-11-01T15:00:10.000Z">
<meta property="article:modified_time" content="2020-03-03T13:37:00.000Z">
<meta property="article:author" content="printempw">
<meta property="article:tag" content="Nginx">
<meta property="article:tag" content="PHP">
<meta property="article:tag" content="Apache">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png">
  <meta name="google-site-verification" content="GRFMvqszPSgldR5B46PfCl67MehNVagYoA9AtJpd8BA" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/han-css@3.3.0/dist/han.min.css">
<link rel="stylesheet" href="https://fonts.loli.net/css?family=Fira+Mono|Roboto+Slab:400,600|Noto+Serif+SC:600&display=swap">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/styles/atom-one-light.min.css">
<link rel="stylesheet" href="/css/main.css">

</head>
<body>

<header>
  <div class="container">
    <div class="site-name">
      <a class="logo" href="/">PRIN BLOG</a>
      <span class="description">åŠåŠå­å…¨æ ˆå¼€å‘è€…çš„æ—¥å¸¸</span>
    </div>
  </div>
</header>

<main>
  <div class="container">
    <div class="row">
      <section class="content col-md-8 col-12">
        
  <article>
    <h1 class="post-title">
      <a href="/setup-nginx-php-on-windows/">Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx/Apache å¼€å‘ç¯å¢ƒ</a>
    </h1>
    <div class="post-meta">
      <span class="post-meta-item post-meta-date">
  <time datetime="2018-11-01T15:00:10+00:00">2018-11-01</time>
</span>

<span class="post-meta-item post-meta-categories">
  <span class="post-meta-item-indicator">Category:</span>
  
    <a class="category-link" href="/categories/tech/">æŠ€æœ¯</a>
  
</span>

<span class="post-meta-item post-meta-tags">
  
    <a class="tag-link" href="/tag/Apache/" rel="tag">Apache</a> <a class="tag-link" href="/tag/Nginx/" rel="tag">Nginx</a> <a class="tag-link" href="/tag/PHP/" rel="tag">PHP</a>
  
</span>


<span class="post-meta-item post-meta-views">
  <span class="pv-counter">loading</span> views
</span>


    </div>

    
      <script src="https://cdn.jsdelivr.net/npm/dayjs@1.8.17/dayjs.min.js"></script>
<script>
  var post_updated = dayjs("2020-03-03T13:37:00.000Z");
  var days_diff_now = dayjs().diff(post_updated, 'days');

  if (days_diff_now > 365) {
    document.write(
      '<div class="post-warning">'+
        'æœ¬æ–‡æœ€åä¿®è®¢äº '+days_diff_now+' å¤©å‰ï¼ˆ'+post_updated.format('YYYY-MM-DD')+'ï¼‰ï¼Œ'+
        'å…¶ä¸­çš„ä¿¡æ¯å¯èƒ½å·²ç»æœ‰æ‰€å‘å±•æˆ–è€…ä¸å†é€‚ç”¨äºç°é˜¶æ®µã€‚'+
      '</div>'
    );
  }
</script>

    

    
      <div class="post-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-å®‰è£…-Nginx-Apache"><span class="toc-text">0x01 å®‰è£… Nginx &#x2F; Apache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-å®‰è£…-PHP"><span class="toc-text">0x02 å®‰è£… PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-é…ç½®-FastCGI-è½¬å‘"><span class="toc-text">0x03 é…ç½® FastCGI è½¬å‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ç¼–å†™å¯åœè„šæœ¬"><span class="toc-text">0x04 ç¼–å†™å¯åœè„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-åè®°"><span class="toc-text">0x05 åè®°</span></a></li></ol></div>
    

    <div class="post-content"><p>çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š</p>
<p><strong>ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ</strong></p>
<p>å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (<a href="https://github.com/printempw/blessing-skin-server/" target="_blank" rel="noopener">printempw/blessing-skin-server</a>) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°<del>ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰</del>ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™ä¸ªç¨‹åºï¼Œè¿˜æœ‰å¯¹å›½å†… Minecraft å¼€å‘ç”Ÿæ€ä»¥åŠç”¨æˆ·ç¾¤ä½“çš„å¤±æœ›ï¼‰ã€‚</p>
<p>ä¸è¿‡æˆ‘çš„æœ‹å‹ <a href="https://blog.gplane.win/" target="_blank" rel="noopener">g-plane</a> è¯´ä»–æ„¿æ„æ¥å‘ï¼Œæ‰€ä»¥ç°åœ¨è¿™ä¸ªé¡¹ç›®çš„åç»­å¼€å‘éƒ½æ˜¯ä»–åœ¨æã€‚è€Œæˆ‘ä¹Ÿä¹å¾—æ¸…é—²ï¼Œåšä¸ªç”©æ‰‹æŒæŸœ <a href="https://blessing.studio/vscode-c-cpp-configuration-for-acm-oj/" target="_blank" rel="noopener">æåˆ«çš„</a> å»äº†ã€‚å½“æˆ‘æ‘¸é±¼æ­£å¿«æ´»æ—¶ï¼Œä»–è¿‡æ¥è”ç³»æˆ‘è¯´å‡†å¤‡å‘å¸ƒ 4.0.0-alpha äº†ï¼Œæˆ‘æ‰æƒ³èµ·æ¥è¿™èŒ¬ï¼šã€Œå•Šï¼Œæˆ‘è¿æ–°ç‰ˆæœ¬é•¿å•¥æ ·éƒ½è¿˜ä¸çŸ¥é“å‘¢ï¼ğŸ˜‚ã€äºæ˜¯æ€¥æ€¥å¿™å¿™ pull äº†æ–°ä»£ç å‡†å¤‡ review ä¸€ä¸‹ï¼Œå´å‘ç°æˆ‘çš„æ–°ç¬”ç”µä¸Šç”šè‡³å‹æ ¹å„¿å°±æ²¡å®‰è£… PHP å¼€å‘ç¯å¢ƒï¼Œåªèƒ½è¯´æ˜¯éå¸¸åœ°çœŸå®ã€‚</p>
<a id="more"></a>

<p>å› ä¸º <a href="https://blessing.studio/phpstudy-prober-page-502-bad-gateway/" target="_blank" rel="noopener">æŸäº›åŸå› </a>ï¼Œæˆ‘ä¸æƒ³ç»§ç»­ä½¿ç”¨é‚£äº› PHP ä¸€é”®åŒ…æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘æ‰“ç®—å…¨éƒ¨è‡ªå·±æ¥ã€‚æœ¬æ–‡è®°å½•äº†æˆ‘æ‰‹åŠ¨å®‰è£…é…ç½® PHP + Nginx/Apache å¼€å‘ç¯å¢ƒçš„è¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°åæ¥äººã€‚</p>
<p>æ³¨æ„ï¼Œæœ¬æ–‡ä¸­çš„é…ç½®é€‚ç”¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œåº”ç”¨è‡³ç”Ÿäº§ç¯å¢ƒæ—¶è¦æ³¨æ„å“¦ã€‚</p>
<blockquote>
<p><strong>2020/03/03 æ›´æ–°</strong>ï¼š</p>
<p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ scoop æ¥ç®¡ç† WNMP å¼€å‘ç¯å¢ƒã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre><code class="cmd">scoop install nginx mariadb php</code></pre>
<p>å¯åŠ¨ï¼š</p>
<pre><code class="cmd">nginx -p %NGINX_HOME%
mysqld --standalone
php-cgi -b 127.0.0.1:9000</code></pre>
<p>é…ç½®æˆ–æ•°æ®æ–‡ä»¶çš„ä½ç½®ï¼š</p>
<pre><code class="plain">C:\Users\printempw\scoop\apps\nginx\current\conf
C:\Users\printempw\scoop\apps\mariadb\current\data
C:\Users\printempw\scoop\apps\php\current\cli</code></pre>
<p>æ¯”èµ·æ‰‹åŠ¨ä¸‹è½½æ–¹ä¾¿ä¸å°‘ã€‚</p>
</blockquote>
<h2 id="0x01-å®‰è£…-Nginx-Apache"><a href="#0x01-å®‰è£…-Nginx-Apache" class="headerlink" title="0x01 å®‰è£… Nginx / Apache"></a>0x01 å®‰è£… Nginx / Apache</h2><p><strong>å¦‚æœä½ ç”¨çš„æ˜¯ Nginxï¼š</strong></p>
<ul>
<li>å» <a href="https://nginx.org/en/download.html" target="_blank" rel="noopener">å®˜ç½‘</a> ä¸‹è½½ Windows ç‰ˆçš„ Nginxï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>nginx-1.14.0.zip</code>ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„åœ°æ–¹ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\nginx</code> é‡Œï¼‰ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>nginx.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸è®¿é—® <code>http://localhost:80</code>ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p>æ¨èä¿®æ”¹çš„ <code>nginx.conf</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="nginx"># å¯ä»¥é€‚å½“è°ƒé«˜ï¼Œä½†ä¸è¦è¶…è¿‡ CPU æ ¸å¿ƒæ•°é‡
worker_processes  4;

events {
    # å¼€å‘ç¯å¢ƒä¸‹ä¸ç”¨å¤ªè€ƒè™‘ worker æœ€å¤§å¹¶å‘è¿æ¥æ•°
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile      on;
    keepalive_timeout 65;

    # å¯ç”¨ gzip
    gzip on;
    gzip_disable &quot;MSIE [1-6].(?!.*SV1)&quot;;
    gzip_http_version 1.1;
    gzip_vary on;
    gzip_proxied any;
    gzip_min_length 1000;
    gzip_buffers 16 8k;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml text/javascript application/json application/x-javascript application/xml application/xml+rss;

    # è¿™é‡Œé¢çš„å†…å®¹ç­‰ 0x03 å†ç»†è¯´
    include vhosts.conf;
}</code></pre>
<p><strong>å¦‚æœä½ ç”¨çš„æ˜¯ Apacheï¼š</strong></p>
<ul>
<li>å› ä¸º Apache å®˜ç½‘å¹¶ä¸æä¾› Windows ç‰ˆçš„æ„å»ºä¸‹è½½ï¼Œæ‰€ä»¥éœ€è¦å» <a href="https://www.apachelounge.com/download/" target="_blank" rel="noopener">Apache Lounge</a> æˆ–è€…å…¶ä»– <a href="https://httpd.apache.org/docs/current/platform/windows.html#down" target="_blank" rel="noopener">å®˜æ–¹æ¨èçš„ç«™ç‚¹</a> ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶åŒ…ï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>httpd-2.4.37-win64-VC15.zip</code>ï¼Œä½ æ„¿æ„çš„è¯ä¹Ÿå¯ä»¥è‡ªå·±ç¼–è¯‘ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„åœ°æ–¹ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\apache</code> é‡Œï¼‰ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>bin/httpd.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸è®¿é—® <code>http://localhost:80</code>ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p>æ¨èä¿®æ”¹çš„ <code>httpd.conf</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="apache"># ä¿®æ”¹ä¸ºä½ çš„å®‰è£…ç›®å½•
Define SRVROOT &quot;E:\environment\apache&quot;
ServerRoot &quot;${SRVROOT}&quot;

Listen 80
ServerName localhost

# æŒ‰éœ€å¯ç”¨æ¨¡å—
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule ...

# æ¨èæ³¨é‡Šæ‰è‡ªå¸¦çš„ DocumentRoot å’Œ &lt;Directory&gt;
# è¿™é‡Œé¢çš„å†…å®¹ç­‰ 0x03 å†ç»†è¯´
Include conf/extra/httpd-php.conf
Include conf/vhosts.conf</code></pre>
<h2 id="0x02-å®‰è£…-PHP"><a href="#0x02-å®‰è£…-PHP" class="headerlink" title="0x02 å®‰è£… PHP"></a>0x02 å®‰è£… PHP</h2><p>Windows ç‰ˆ PHP ä¸‹è½½åœ°å€ï¼š</p>
<p><a href="https://windows.php.net/download" target="_blank" rel="noopener">https://windows.php.net/download</a></p>
<p>å…¶ä¸­æœ‰ NTSï¼ˆNon Thread Safeï¼Œéçº¿ç¨‹å®‰å…¨ï¼‰å’Œ TSï¼ˆThread Safeï¼Œçº¿ç¨‹å®‰å…¨ï¼‰ä¸¤ç§ç‰ˆæœ¬ï¼Œç®€å•æ¥è¯´å°±æ˜¯ <strong>Nginx ç”¨ NTS ç‰ˆï¼ŒApache é€šå¸¸ç”¨ TS ç‰ˆ</strong>ï¼ˆä¹Ÿå¯ä»¥ç”¨ NTSï¼‰ï¼Œå®ƒä»¬ä¹‹é—´çš„å…·ä½“åŒºåˆ«æœ‰å…´è¶£çš„è¯å¯ä»¥è‡ªå·±å»äº†è§£ä¸€ä¸‹ã€‚</p>
<p>ä¸ºäº†åŒæ—¶å…¼å®¹ Nginx ä¸ Apacheï¼Œæœ¬æ–‡å°†ä»¥ NTS ç‰ˆä¸ºä¾‹è¿›è¡Œé…ç½®ã€‚</p>
<ul>
<li>ä¸‹è½½åˆé€‚çš„ç‰ˆæœ¬ï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>php-7.2.11-nts-Win32-VC15-x64.zip</code>ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„ä½ç½®ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\php</code> é‡Œï¼‰ï¼›</li>
<li>å¤åˆ¶ä¸€ä»½ <code>php.ini-development</code>ï¼Œé‡å‘½åä¸º <code>php.ini</code> å¹¶é€‚å½“ä¿®æ”¹å…¶ä¸­é…ç½®ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>php.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸æ‰“å¼€ PHP Interactive Shellï¼Œå°±å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p><strong>å¦‚æœæ— æ³•è¿è¡Œï¼Œè¯·æ£€æŸ¥ä½ æ˜¯å¦å®‰è£…äº†å¯¹åº”çš„ VC è¿è¡Œåº“ã€‚</strong></p>
<p>æ¨èä¿®æ”¹çš„ <code>php.ini</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="ini">; æ‰©å±•æ‰€åœ¨çš„ç›®å½•ï¼Œè‡ªè¡Œä¿®æ”¹
extension_dir = &quot;E:\environment\php\ext&quot;
; æŒ‰è‡ªå·±çš„éœ€æ±‚å¯ç”¨æ‰©å±•
extension=pdo_mysql
extension=...
; å„ç§ç¼“å­˜çš„ä½ç½®
sys_temp_dir = &quot;E:\environment\php\temp&quot;
upload_tmp_dir = &quot;E:\environment\php\temp&quot;
session.save_path = &quot;E:\environment\php\temp&quot;
; å…¶ä»–æ‚ä¸ƒæ‚å…«çš„
upload_max_filesize = 100M
date.timezone = Asia/Shanghai</code></pre>
<h2 id="0x03-é…ç½®-FastCGI-è½¬å‘"><a href="#0x03-é…ç½®-FastCGI-è½¬å‘" class="headerlink" title="0x03 é…ç½® FastCGI è½¬å‘"></a>0x03 é…ç½® FastCGI è½¬å‘</h2><p>æ¥ä¸‹æ¥æ‰æ˜¯é‡å¤´æˆï¼Œæˆ‘ä»¬è¦è®© Web Server ä¸ PHP èƒ½å¤Ÿäº’ç›¸é€šä¿¡ä»¥å®Œæˆè¯·æ±‚ã€‚</p>
<p>ä½œä¸º Web Server çš„åç«¯æ—¶ï¼ŒPHP ä¸»è¦æœ‰ä¸¤ç§è¿è¡Œæ–¹å¼ï¼Œä¸€ç§æ˜¯ <strong>ç‹¬ç«‹è¿›ç¨‹ã€ä½¿ç”¨ <a href="http://www.nowamagic.net/librarys/veda/detail/1319" target="_blank" rel="noopener">FastCGI åè®®</a> ä¸ Web Server é€šä¿¡</strong>ï¼ˆNginx ç”¨çš„å°±æ˜¯è¿™ç§ï¼‰ï¼Œå¦å¤–ä¸€ç§æ˜¯ <strong>ä½œä¸ºæ¨¡å—ç›´æ¥åŠ è½½åˆ° Web Server ä¸­</strong>ï¼ˆæ¯”å¦‚ Apache çš„ <code>mod_php</code> æ¨¡å—ï¼Œä¸è¿‡ Apache ä¹Ÿæ”¯æŒ FastCGI æ–¹å¼ï¼‰ã€‚è¯¦ç»†çš„åŸç†æˆ‘å°±ä¸ä»‹ç»äº†ï¼Œæœ‰å…´è¶£çš„é€‰æ‰‹å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚</p>
<p>ä¸ºäº†èƒ½å¤ŸåŒæ—¶å…¼å®¹ Nginx å’Œ Apacheï¼Œ<strong>æœ¬æ–‡å‡ä½¿ç”¨ FastCGI æ–¹å¼åŠ è½½ PHP</strong>ã€‚</p>
<hr>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹ PHP çš„ FastCGI è¿›ç¨‹ç®¡ç†å™¨ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºç›´æ¥è¿è¡Œ PHP çš„ FastCGI è¿›ç¨‹ï¼ˆåœ¨ Windows ä¸Šå°±æ˜¯ <code>php-cgi.exe</code>ï¼‰æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ul>
<li>é…ç½®æ–‡ä»¶ <code>php.ini</code> ä¿®æ”¹åæ— æ³•å¹³æ»‘é‡è½½ï¼Œéœ€è¦é‡æ–°å¯åŠ¨ <code>php-cgi</code> è¿›ç¨‹ï¼›</li>
<li>Windows ä¸‹ <code>php-cgi</code> é»˜è®¤å¤„ç† 500 ä¸ªè¯·æ±‚åå°±è‡ªåŠ¨é€€å‡ºï¼ˆ<code>PHP_FCGI_MAX_REQUESTS</code>ï¼‰ï¼›</li>
<li>å¦‚æœå› ä¸ºå…¶ä»–åŸå› é€ æˆ <code>php-cgi</code> è¿›ç¨‹å´©æºƒï¼Œå°±æ— æ³•å¤„ç†åç»­è¯·æ±‚äº†ã€‚</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»ä¼¼å®ˆæŠ¤è¿›ç¨‹çš„ä¸œè¥¿ï¼Œæ¥ä¿è¯å§‹ç»ˆæœ‰ä¸€å®šæ•°é‡çš„ <code>php-cgi</code> è¿›ç¨‹åœ¨è¿è¡Œã€‚<a href="http://php.net/manual/zh/install.fpm.php" target="_blank" rel="noopener">PHP-FPM</a> (PHP FastCGI Process Manager) æ˜¯ PHP å®˜æ–¹é’¦å®šçš„ FastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œå®ƒåªé€‚ç”¨äºç±» Unix ç³»ç»Ÿã€‚åœ¨ Windows ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ›¿ä»£å“æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼ˆ<strong>Apache ç”¨æˆ·ä¸éœ€è¦é…ç½®è¿™äº›ä¸œè¥¿</strong>ï¼Œå› ä¸ºå®ƒçš„ <code>mod_fcgid</code> æ¨¡å—è‡ªå¸¦ FastCGI è¿›ç¨‹ç®¡ç†åŠŸèƒ½ï¼‰ï¼š</p>
<ul>
<li><a href="https://github.com/78/xxfpm" target="_blank" rel="noopener">xxfpm</a></li>
<li><a href="https://github.com/deemru/php-cgi-spawner" target="_blank" rel="noopener">php-cgi-spawner</a></li>
<li><a href="https://github.com/lighttpd/spawn-fcgi" target="_blank" rel="noopener">spawn-fcgi</a></li>
</ul>
<p>æœ¬æ–‡å°†ä»¥ php-cgi-spawner ä¸ºä¾‹è¿›è¡Œé…ç½®ã€‚</p>
<ul>
<li><p>åœ¨ <a href="https://github.com/deemru/php-cgi-spawner/releases" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½ç¼–è¯‘å¥½çš„ <code>php-cgi-spawner.exe</code>ï¼›</p>
</li>
<li><p>æ”¾åˆ° PHP çš„å®‰è£…ç›®å½•ä¸‹ï¼ˆæœ¬æ–‡ä¸º <code>E:\environment\php</code>ï¼‰ï¼›</p>
</li>
<li><p>æ‰“å¼€ PowerShell æˆ–è€… CMDï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="powershell"># ä»¤ PHP FastCGI å¤„ç†ç¨‹åºç›‘å¬åœ¨ 9000 ç«¯å£ä¸Š
# è‡³å°‘å¼€å¯ 4 ä¸ª php-cgi è¿›ç¨‹ï¼Œé«˜è´Ÿè½½æ—¶æœ€å¤šå¯ä»¥å¼€åˆ° 16 ä¸ª
.\php-cgi-spawner.exe &quot;php-cgi.exe -c php.ini&quot; 9000 4+16</code></pre>
</li>
<li><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ å°†å¯ä»¥åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­çœ‹åˆ°åŒæ—¶è¿è¡Œçš„å¤šä¸ª <code>php-cgi</code> è¿›ç¨‹ã€‚</p>
</li>
</ul>
<p><img src="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png" srcset="/images/loading.jpg" data-srcset="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png" alt="php-cgi-processes"></p>
<p><strong>æ¥ä¸‹æ¥ä¿®æ”¹ Nginx é…ç½®</strong>ï¼ˆå³ 0x01 ä¸­æåˆ°çš„ <code>vhosts.conf</code> ä¸­çš„å†…å®¹ï¼‰ï¼Œé€šè¿‡ FastCGI åè®®å°†è¯·æ±‚è½¬å‘ç»™ç›‘å¬åœ¨ 9000 ç«¯å£ä¸Šçš„ PHP è¿›è¡Œå¤„ç†ï¼š</p>
<pre><code class="nginx">server {
    listen       80;
    server_name  localhost;
    root   E:/wwwroot;
    index  index.html index.htm index.php;

    location ~ [^/]\.php(/|$) {
        # ä» URI ä¸­åˆ†ç¦»å‡º $fastcgi_script_name å’Œ $fastcgi_path_info çš„å€¼
        # ä¸æ¨èä½¿ç”¨ php.ini ä¸­çš„ cgi.fix_pathinfo é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¼šé€ æˆå®‰å…¨éšæ‚£
        # è™½ç„¶æˆ‘æ„Ÿè§‰ 8012 å¹´äº†åº”è¯¥æ²¡äººç”¨ PATH_INFO äº†â€¦â€¦ä¸éœ€è¦çš„è¯å»æ‰å³å¯
        fastcgi_split_path_info  ^(.+?\.php)(/.*)$;
        fastcgi_param  PATH_INFO  $fastcgi_path_info;

        # å½“è¯·æ±‚çš„ .php æ–‡ä»¶ä¸å­˜åœ¨æ—¶ç›´æ¥è¿”å› 404
        # ä¸ç„¶äº¤ç»™ PHP å¤„ç†çš„è¯é‚£è¾¹å°±ä¼šè¿”å› No input file specified.
        if (!-f $document_root$fastcgi_script_name) {
            return 404;
        }

        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;
        # è‡ªå¸¦çš„é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢è®¾ç½®äº†ä¸€å¤§å † CGI åè®®ä¸­çš„å˜é‡
        include        fastcgi.conf;
    }
}</code></pre>
<hr>
<p><strong>Apache ç”¨æˆ·ä¸éœ€è¦æ‰‹åŠ¨é…ç½® PHP FastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼Œç›¸å¯¹ç®€å•ä¸€äº›ï¼š</strong></p>
<ul>
<li>åœ¨ä¸Šé¢æåˆ°çš„ <a href="https://www.apachelounge.com/download/" target="_blank" rel="noopener">Apache Lounge</a> ä¸Šä¸‹è½½ç¼–è¯‘å¥½çš„ <code>mod_fcgid</code> æ¨¡å—ï¼›</li>
<li>è§£å‹åï¼Œå°† <code>mod_fcgid.so</code> æ”¾å…¥ Apache çš„ <code>modules</code> ç›®å½•ï¼›</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶åŠ è½½æ¨¡å—ï¼ˆå³ 0x01 ä¸­æåˆ°çš„ <code>conf/extra/httpd-php.conf</code>ï¼‰ï¼š</li>
</ul>
<pre><code class="apache"># å¦‚æœå«Œéº»çƒ¦çš„è¯è¿™ä¸€æ®µä¹Ÿå¯ä»¥ç›´æ¥æ”¾åˆ° httpd.conf é‡Œé¢å»
LoadModule fcgid_module modules/mod_fcgid.so

&lt;IfModule fcgid_module&gt;
FcgidInitialEnv PHPRC &quot;E:/environment/php/&quot;
FcgidInitialEnv PHP_FCGI_MAX_REQUESTS 1000
AddHandler fcgid-script .php
FcgidWrapper &quot;E:/environment/php/php-cgi.exe&quot; .php
FcgidIOTimeout 384
FcgidConnectTimeout 360
FcgidOutputBufferSize 128
FcgidMaxRequestsPerProcess 1000
FcgidMinProcessesPerClass 0
FcgidMaxProcesses 16
FcgidMaxRequestLen 268435456
ProcessLifeTime 360
&lt;/IfModule&gt;</code></pre>
<ul>
<li>ç¼–è¾‘ <code>conf/vhosts.conf</code> å…è®¸è¿è¡Œ CGI ç¨‹åºï¼š</li>
</ul>
<pre><code class="apache">&lt;VirtualHost localhost:80&gt;
  DocumentRoot &quot;E:\wwwroot&quot;
  &lt;Directory &quot;E:\wwwroot&quot;&gt;
    DirectoryIndex index.html index.php
    # æ³¨æ„è¿™é‡Œçš„ +ExecCGIï¼Œä¸åŠ çš„è¯ä¼š 403
    Options -Indexes -FollowSymLinks +ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
    Require all granted
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;</code></pre>
<p>å¦‚æœä¸€åˆ‡é…ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥å°±èƒ½æ­£å¸¸è®¿é—® PHP ç½‘é¡µäº†ã€‚</p>
<p><img src="https://img.blessing.studio/images/2018/11/01/nginx-php-works.png" srcset="/images/loading.jpg" data-srcset="https://img.blessing.studio/images/2018/11/01/nginx-php-works.png" alt="nginx-php-works"></p>
<h2 id="0x04-ç¼–å†™å¯åœè„šæœ¬"><a href="#0x04-ç¼–å†™å¯åœè„šæœ¬" class="headerlink" title="0x04 ç¼–å†™å¯åœè„šæœ¬"></a>0x04 ç¼–å†™å¯åœè„šæœ¬</h2><p>è™½ç„¶æ•´ä¸ªç³»ç»Ÿæ˜¯è·‘èµ·æ¥äº†ï¼Œä½†æ€»ä¸èƒ½æ¯æ¬¡å¯åŠ¨éƒ½å¾—å¼€ä¸€å¤§å †æ§åˆ¶å°çª—å£å§ï¼Ÿå¼„ä¸ªå°å·¥å…·ç®¡ç† Nginx/Apache å’Œ PHP çš„è¿›ç¨‹è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚å„ç§ä¸€é”®åŒ…ä¸­ä¸€èˆ¬éƒ½è‡ªå¸¦äº†æ–¹ä¾¿å¥½ç”¨çš„ç•Œé¢æ¥ç®¡ç†è¿™äº›è¿›ç¨‹ï¼Œä¸è¿‡æ—¢ç„¶æˆ‘ä»¬é€‰æ‹©äº†æ‰‹åŠ¨é…ç½®ï¼Œé‚£è¿™ä¸€å—ä¹Ÿå¾—æˆ‘ä»¬è‡ªå·±æå®šäº†ã€‚å› ä¸ºå›¾æ–¹ä¾¿ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ Windows çš„æ‰¹å¤„ç†è„šæœ¬ï¼ˆBatch Fileï¼‰æ¥å®Œæˆè¿™é¡¹éœ€æ±‚ï¼Œä¿å­˜ä¸º <code>.bat</code> æ–‡ä»¶åŒå‡»è¿è¡Œå°±å®Œäº‹å„¿äº†ã€‚</p>
<p><strong>å¯åŠ¨ Nginx å’Œ PHPï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF
set nginx_home=..\nginx
set php_home=..\php

ECHO Starting PHP FastCGI...
.\RunHiddenConsole.exe %php_home%\php-cgi-spawner.exe &quot;%php_home%\php-cgi.exe -c %php_home%\php.ini&quot; 9000 4+16

ECHO Starting Nginx...
.\RunHiddenConsole.exe %nginx_home%\nginx.exe -p %nginx_home%</code></pre>
<p><strong>åœæ­¢ Nginx å’Œ PHPï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF

ECHO Stopping nginx...
taskkill /F /IM nginx.exe &gt; nul

ECHO Stopping PHP FastCGI...
taskkill /F /IM php-cgi-spawner.exe &gt; nul
taskkill /F /IM php-cgi.exe &gt; nul</code></pre>
<p><strong>é‡è½½ Nginx é…ç½®ï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF
set nginx_home=..\nginx

ECHO Reloading Nginx...
%nginx_home%\nginx.exe -s reload</code></pre>
<p><strong>å¯åŠ¨ Apache</strong>ï¼ˆApache ä¼šå¸®æˆ‘ä»¬å¯åŠ¨ PHP çš„ï¼‰ï¼š</p>
<pre><code class="cmd">@ECHO OFF
set apache_home=..\apache

ECHO Starting Apache Httpd...
.\RunHiddenConsole.exe %apache_home%\bin\httpd.exe</code></pre>
<p><strong>åœæ­¢ Apacheï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF

ECHO Stopping Apache Httpd...
taskkill /F /IM httpd.exe &gt; nul</code></pre>
<p>è¿™äº›è„šæœ¬æˆ‘æ”¾åœ¨ <code>E:\environment\scripts</code> ç›®å½•ä¸­ï¼Œå¦‚æœä½ éœ€è¦æ”¾åœ¨å…¶ä»–åœ°æ–¹ï¼Œè¯·é€‚å½“ä¿®æ”¹è„šæœ¬ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€‚å¦å¤–ï¼Œè„šæœ¬ä¸­ç”¨åˆ°äº† <code>RunHiddenConsole.exe</code> æ¥éšè—å‘½ä»¤è¡Œçª—å£ï¼Œä½ å¯ä»¥åœ¨ <a href="http://redmine.lighttpd.net/attachments/660/RunHiddenConsole.zip" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½åˆ°è¿™ä¸ªå°å·¥å…·ã€‚</p>
<p><img src="https://img.blessing.studio/images/2018/11/01/wnmp-all-processes.png" srcset="/images/loading.jpg" data-srcset="https://img.blessing.studio/images/2018/11/01/wnmp-all-processes.png" alt="wnmp-all-processes"></p>
<h2 id="0x05-åè®°"><a href="#0x05-åè®°" class="headerlink" title="0x05 åè®°"></a>0x05 åè®°</h2><p>é…ç½®å®Œæˆåçš„ç›®å½•ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼ˆæœ‰çœç•¥ï¼‰ï¼š</p>
<pre><code class="text">E:\environment&gt; tree
.
â”œâ”€â”€ apache
â”‚   â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ cgi-bin
â”‚   â”œâ”€â”€ conf
â”‚   â”‚   â”œâ”€â”€ extra
â”‚   â”‚   â”œâ”€â”€ original
â”‚   â”‚   â”œâ”€â”€ charset.conv
â”‚   â”‚   â”œâ”€â”€ httpd.conf *
â”‚   â”‚   â”œâ”€â”€ magic
â”‚   â”‚   â”œâ”€â”€ mime.types
â”‚   â”‚   â”œâ”€â”€ openssl.cnf
â”‚   â”‚   â””â”€â”€ vhosts.conf *
â”‚   â”œâ”€â”€ include
â”‚   â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ logs
â”‚   â””â”€â”€ modules
â”œâ”€â”€ mysql
â”‚   â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ data
â”‚   â”œâ”€â”€ include
â”‚   â”œâ”€â”€ lib
â”‚   â””â”€â”€ share
â”œâ”€â”€ nginx
â”‚   â”œâ”€â”€ conf
â”‚   â”‚   â”œâ”€â”€ fastcgi.conf
â”‚   â”‚   â”œâ”€â”€ fastcgi_params
â”‚   â”‚   â”œâ”€â”€ koi-utf
â”‚   â”‚   â”œâ”€â”€ koi-win
â”‚   â”‚   â”œâ”€â”€ mime.types
â”‚   â”‚   â”œâ”€â”€ nginx.conf *
â”‚   â”‚   â”œâ”€â”€ scgi_params
â”‚   â”‚   â”œâ”€â”€ uwsgi_params
â”‚   â”‚   â”œâ”€â”€ vhosts.conf *
â”‚   â”‚   â””â”€â”€ win-utf
â”‚   â”œâ”€â”€ contrib
â”‚   â”œâ”€â”€ logs
â”‚   â””â”€â”€ nginx.exe
â”œâ”€â”€ php
â”‚   â”œâ”€â”€ dev
â”‚   â”œâ”€â”€ ext
â”‚   â”œâ”€â”€ extras
â”‚   â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ sasl2
â”‚   â”œâ”€â”€ temp
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ php7.dll
â”‚   â”œâ”€â”€ php-cgi.exe
â”‚   â”œâ”€â”€ php-cgi-spawner.exe *
â”‚   â”œâ”€â”€ php.exe
â”‚   â””â”€â”€ php.ini *
â””â”€â”€ scripts
    â”œâ”€â”€ reload-nginx.bat
    â”œâ”€â”€ restart-nginx.bat
    â”œâ”€â”€ RunHiddenConsole.exe
    â”œâ”€â”€ start-all.bat
    â”œâ”€â”€ start-apache.bat
    â”œâ”€â”€ start-mysql.bat
    â”œâ”€â”€ start-nginx.bat
    â”œâ”€â”€ stop-all.bat
    â”œâ”€â”€ stop-apache.bat
    â”œâ”€â”€ stop-mysql.bat
    â””â”€â”€ stop-nginx.bat</code></pre>
<p>éå¸¸æ¸…çˆ½ï¼Œæœ‰ç§ä¸€åˆ‡å°½åœ¨æŒæ§ä¸­çš„æ„Ÿè§‰ï¼Œæˆ‘å–œæ¬¢ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸€å PHP å¼€å‘è€…ï¼Œå´ä»æ¥æ²¡æœ‰æ‰‹åŠ¨é…ç½®è¿‡ PHP ç¯å¢ƒçš„è¯ï¼Œé‚£æˆ‘å»ºè®®ä½ å°è¯•ä¸€ä¸‹ã€‚è™½ç„¶ç”Ÿäº§ç¯å¢ƒä¸Šä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨æˆç†Ÿçš„ä¸€é”®åŒ…ï¼Œä¸è¿‡æ‰‹åŠ¨é…ç½®ä¸€ä¸‹è¿™ä¸€å¥—ä¸œè¥¿å¯ä»¥æ›´æ·±å…¥åœ°äº†è§£ PHP ä¸ Web Server çš„åä½œæœºåˆ¶ï¼Œè¿™å¯¹äºç¼–å†™ä¸Šå±‚åº”ç”¨ä»¥åŠè¿ç»´ä¹Ÿæ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚</p>
<p>æœ¬æ¥æƒ³é¡ºå¸¦å‡‘é½ä¸€å¥— WNMPï¼Œä½†æ˜¯ MySQL çš„å®‰è£…é…ç½®ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œè€Œä¸”ä¹Ÿä¸åƒ PHP ä¸ Web Server é‚£æ ·è€¦åˆç´§å¯†ï¼Œæ‰€ä»¥è¿™é‡Œå°±æŒ‰ä¸‹ä¸è¡¨ã€‚</p>
</div>
    <div class="post-copyright"><p>é™¤å¦æœ‰å£°æ˜å¤–ï¼Œæœ¬åšå®¢æ–‡ç« å‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">çŸ¥è¯†å…±äº«(Creative Commons) ç½²å 4.0 å›½é™…è®¸å¯åè®®</a> è¿›è¡Œè®¸å¯ã€‚è½¬è½½è¯·æ³¨æ˜åŸä½œè€…ä¸æ–‡ç« å‡ºå¤„ã€‚</p></div>
  </article>

  
    <nav class="post-nav">
      
      <div class="post-nav-item post-nav-prev">ä¸Šä¸€ç¯‡ï¼š
        <a href="/hexo-plugin-to-make-posts-sage-unlisted/">ä¸º Hexo åšå®¢æ·»åŠ éšè—æ–‡ç« åŠŸèƒ½</a>
      </div>
      
      
      <div class="post-nav-item post-nav-next">ä¸‹ä¸€ç¯‡ï¼š
        <a href="/live-stream-recorder-for-vtuber-fans/">ä¸€ç§ç›‘æµ‹ VTuber ç›´æ’­å¹¶è‡ªåŠ¨å½•åƒçš„æ–¹æ³•</a>
      </div>
      
    </nav>
  

  
    

<div class="comments" id="disqus_thread"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.6/dist/disqusjs.css">
<script src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.6/dist/disqus.js"></script>
<script>
  // Load comments with DisqusJS
  function loadComments() {
    window.dsqjs = new DisqusJS({
      shortname: 'blessing-studio',
      siteName: 'PRIN BLOG',
      identifier: "setup-nginx-php-on-windows/".replace('index.html', '').replace(/\/$/, ''),
      url: "https://printempw.github.io/setup-nginx-php-on-windows/".replace('index.html', ''),
      title: 'Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx/Apache å¼€å‘ç¯å¢ƒ',
      api: 'https://disqus.printempw.workers.dev/api/',
      apikey: '5O1HIIFsAWX3lBOQveU8qWPPAd2aLyf1fklehBAfcQ7S9Jo8y4acIrmyO2uxMD35',
      admin: 'printempw',
      adminLabel: 'åšä¸»'
    });
  }

  // Lazy load 
  (function () {
    var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
    if (offsetTop <= 0) {
      // Load directly when there's no scrollbar
      window.addEventListener('load', loadComments, false);
    } else {
      var disqusScroll = function () {
        // offsetTop may changes because of manually resizing browser window or lazy loading images
        var offsetTop = document.getElementById('disqus_thread').offsetTop - window.innerHeight;
        var scrollTop = window.scrollY;

        // Pre-load comments a bit? (margin or anything else)
        if (offsetTop - scrollTop < 60) {
          window.removeEventListener('scroll', disqusScroll);
          loadComments();
        }
      };
      window.addEventListener('scroll', disqusScroll);
    }
  })();

  // Scroll to comments automatically if #comment-xxx anchor specified
  window.addEventListener('load', function () {
    // I don't know why, it just works.
    window.setTimeout(function () {
      if (location.hash.indexOf('#comment-') !== -1) {
        document.getElementById('disqus_thread').scrollIntoView(true);
      }
    }, 100);
  }, false);
</script>



  

      </section>
      <aside class="sidebar col-md-3 offset-md-1 col-12">
        
  
  <section class="widget widget-toc">
    <h3 class="widget-title">æ–‡ç« ç›®å½•</h3>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-å®‰è£…-Nginx-Apache"><span class="toc-text">0x01 å®‰è£… Nginx &#x2F; Apache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-å®‰è£…-PHP"><span class="toc-text">0x02 å®‰è£… PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-é…ç½®-FastCGI-è½¬å‘"><span class="toc-text">0x03 é…ç½® FastCGI è½¬å‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ç¼–å†™å¯åœè„šæœ¬"><span class="toc-text">0x04 ç¼–å†™å¯åœè„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-åè®°"><span class="toc-text">0x05 åè®°</span></a></li></ol>
  </section>
  

        

<section class="widget" id="widget-pages">
  <h3 class="widget-title">é¡µé¢</h3>
  <ul class="menu">
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives/" title="">å½’æ¡£</a>
      </li>
    
      
      <li class="menu-item menu-item-about">
        <a href="/about/" title="">å…³äºæˆ‘</a>
      </li>
    
      
      <li class="menu-item menu-item-friends">
        <a href="/friends/" title="">æœ‹å‹ä»¬</a>
      </li>
    
  </ul>
</section>

<section class="widget" id="widget-categories">
  <h3 class="widget-title">åˆ†ç±»</h3>
  
  
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">æŠ€æœ¯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">æ—¥å¸¸</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/essay/">éšç¬”</a></li></ul>
  
</section>



<section class="widget" id="widget-links">
  <h3 class="widget-title">å…¶ä»–</h3>
  <ul class="menu">
    
      
      <li class="menu-item menu-item-github">
        <a href="https://github.com/printempw" title="" target="_blank">GitHub</a>
      </li>
    
      
      <li class="menu-item menu-item-rss">
        <a href="/atom.xml" title="" target="_blank">RSS Feed</a>
      </li>
    
      
      <li class="menu-item menu-item-twitter">
        <a href="https://twitter.com/printempw" title="" target="_blank">Twitter</a>
      </li>
    
  </ul>
</section>

      </aside>
    </div>
  </div>
</main>

<footer>
  
  <div class="container">
    <p>
      &copy; 2020 <a href="https://printempw.github.io">PRIN BLOG</a>. Proudly published with
      <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/printempw/hexo-theme-murasaki/" target="_blank">Murasaki</a>.
    </p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/han-css@3.3.0/dist/han.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/highlight.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@12.4.0/dist/lazyload.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
  Han(document.querySelector('section.content')).setRoutine([
    'initCond', 'renderElem', 'renderJiya', 'correctBasicBD', 'substCombLigaWithPUA'
    // 'renderHanging', 'renderHWS'
  ]).render();
  new LazyLoad({
    elements_selector: '.post-content img',
    callback_loaded: function (el) {
      el.parentNode.nodeName.toLowerCase() === 'a' || mediumZoom(el, { margin: 24 });
    }
  });
</script>
    <script>
      window.ga_tid = 'UA-65656002-1';
      window.ga_api = 'https://ga.printempw.workers.dev/';
    </script>
    <script src="https://cdn.jsdelivr.net/npm/cfga@1.0.1/cfga.min.js"></script>
  
  <script>
    window.post_views_api = 'https://work.prinzeugen.net/api/pageviews';
  </script>
  <script src="/js/post-views.js"></script>

</body>
</html>
